import{B as Ie}from"./Button-BEa7U3jO.js";import{S as Me,I as ae}from"./Index-BXfYA563.js";import{B as Be}from"./BlockLabel-CR_JnqLq.js";import{E as Ee}from"./Empty-CEggepS0.js";import{M as ze,a as qe}from"./Minimize-X5PPawdt.js";import{I as oe}from"./Image-Bsh8Umrh.js";import{I as Ne}from"./IconButtonWrapper-Cbc1cIwN.js";import"./index-6jqsFzvP.js";import{r as Z}from"./file-url-DoRRNcdi.js";import"./svelte/svelte.js";const{SvelteComponent:Se,append:C,assign:Fe,attr:v,binding_callbacks:Le,check_outros:Q,create_component:z,destroy_component:q,destroy_each:ue,detach:I,element:P,empty:re,ensure_array_like:$,flush:w,get_spread_object:Pe,get_spread_update:je,group_outros:R,init:Ce,insert:M,listen:j,mount_component:N,noop:fe,run_all:Ve,safe_not_equal:We,set_data:$e,set_style:y,space:S,src_url_equal:A,text:Ae,toggle_class:E,transition_in:k,transition_out:p}=window.__gradio__svelte__internal,{onMount:De}=window.__gradio__svelte__internal;function x(t,e,n){const l=t.slice();return l[32]=e[n],l[34]=n,l}function ee(t,e,n){const l=t.slice();return l[32]=e[n],l[34]=n,l}function Ge(t){let e,n,l,i,s,a,f,b,g;n=new Ne({props:{$$slots:{default:[Je]},$$scope:{ctx:t}}});let h=$(t[15]?t[15]?.annotations:[]),_=[];for(let r=0;r<h.length;r+=1)_[r]=ne(ee(t,h,r));let m=t[6]&&t[15]&&ie(t);return{c(){e=P("div"),z(n.$$.fragment),l=S(),i=P("img"),a=S();for(let r=0;r<_.length;r+=1)_[r].c();f=S(),m&&m.c(),b=re(),v(i,"class","base-image svelte-303fln"),A(i.src,s=t[15]?t[15].image.url:null)||v(i,"src",s),v(i,"alt","the base file that is annotated"),E(i,"fit-height",t[7]&&!t[17]),v(e,"class","image-container svelte-303fln")},m(r,u){M(r,e,u),N(n,e,null),C(e,l),C(e,i),C(e,a);for(let c=0;c<_.length;c+=1)_[c]&&_[c].m(e,null);t[26](e),M(r,f,u),m&&m.m(r,u),M(r,b,u),g=!0},p(r,u){const c={};if(u[0]&147456|u[1]&32&&(c.$$scope={dirty:u,ctx:r}),n.$set(c),(!g||u[0]&32768&&!A(i.src,s=r[15]?r[15].image.url:null))&&v(i,"src",s),(!g||u[0]&131200)&&E(i,"fit-height",r[7]&&!r[17]),u[0]&229904){h=$(r[15]?r[15]?.annotations:[]);let d;for(d=0;d<h.length;d+=1){const B=ee(r,h,d);_[d]?_[d].p(B,u):(_[d]=ne(B),_[d].c(),_[d].m(e,null))}for(;d<_.length;d+=1)_[d].d(1);_.length=h.length}r[6]&&r[15]?m?m.p(r,u):(m=ie(r),m.c(),m.m(b.parentNode,b)):m&&(m.d(1),m=null)},i(r){g||(k(n.$$.fragment,r),g=!0)},o(r){p(n.$$.fragment,r),g=!1},d(r){r&&(I(e),I(f),I(b)),q(n),ue(_,r),t[26](null),m&&m.d(r)}}}function He(t){let e,n;return e=new Ee({props:{size:"large",unpadded_box:!0,$$slots:{default:[Ke]},$$scope:{ctx:t}}}),{c(){z(e.$$.fragment)},m(l,i){N(e,l,i),n=!0},p(l,i){const s={};i[1]&32&&(s.$$scope={dirty:i,ctx:l}),e.$set(s)},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){p(e.$$.fragment,l),n=!1},d(l){q(e,l)}}}function le(t){let e,n;return e=new ae({props:{Icon:ze,label:"View in full screen"}}),e.$on("click",t[19]),{c(){z(e.$$.fragment)},m(l,i){N(e,l,i),n=!0},p:fe,i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){p(e.$$.fragment,l),n=!1},d(l){q(e,l)}}}function te(t){let e,n;return e=new ae({props:{Icon:qe,label:"Exit full screen"}}),e.$on("click",t[19]),{c(){z(e.$$.fragment)},m(l,i){N(e,l,i),n=!0},p:fe,i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){p(e.$$.fragment,l),n=!1},d(l){q(e,l)}}}function Je(t){let e,n,l,i=!t[17]&&t[14]&&le(t),s=t[17]&&te(t);return{c(){i&&i.c(),e=S(),s&&s.c(),n=re()},m(a,f){i&&i.m(a,f),M(a,e,f),s&&s.m(a,f),M(a,n,f),l=!0},p(a,f){!a[17]&&a[14]?i?(i.p(a,f),f[0]&147456&&k(i,1)):(i=le(a),i.c(),k(i,1),i.m(e.parentNode,e)):i&&(R(),p(i,1,1,()=>{i=null}),Q()),a[17]?s?(s.p(a,f),f[0]&131072&&k(s,1)):(s=te(a),s.c(),k(s,1),s.m(n.parentNode,n)):s&&(R(),p(s,1,1,()=>{s=null}),Q())},i(a){l||(k(i),k(s),l=!0)},o(a){p(i),p(s),l=!1},d(a){a&&(I(e),I(n)),i&&i.d(a),s&&s.d(a)}}}function ne(t){let e,n,l,i;return{c(){e=P("img"),v(e,"alt",n="segmentation mask identifying "+t[4]+" within the uploaded file"),v(e,"class","mask fit-height svelte-303fln"),A(e.src,l=t[32].image.url)||v(e,"src",l),v(e,"style",i=t[9]&&t[32].label in t[9]?null:`filter: hue-rotate(${Math.round(t[34]*360/t[15]?.annotations.length)}deg);`),E(e,"fit-height",!t[17]),E(e,"active",t[16]==t[32].label),E(e,"inactive",t[16]!=t[32].label&&t[16]!=null)},m(s,a){M(s,e,a)},p(s,a){a[0]&16&&n!==(n="segmentation mask identifying "+s[4]+" within the uploaded file")&&v(e,"alt",n),a[0]&32768&&!A(e.src,l=s[32].image.url)&&v(e,"src",l),a[0]&33280&&i!==(i=s[9]&&s[32].label in s[9]?null:`filter: hue-rotate(${Math.round(s[34]*360/s[15]?.annotations.length)}deg);`)&&v(e,"style",i),a[0]&131072&&E(e,"fit-height",!s[17]),a[0]&98304&&E(e,"active",s[16]==s[32].label),a[0]&98304&&E(e,"inactive",s[16]!=s[32].label&&s[16]!=null)},d(s){s&&I(e)}}}function ie(t){let e,n=$(t[15].annotations),l=[];for(let i=0;i<n.length;i+=1)l[i]=se(x(t,n,i));return{c(){e=P("div");for(let i=0;i<l.length;i+=1)l[i].c();v(e,"class","legend svelte-303fln")},m(i,s){M(i,e,s);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(i,s){if(s[0]&7373312){n=$(i[15].annotations);let a;for(a=0;a<n.length;a+=1){const f=x(i,n,a);l[a]?l[a].p(f,s):(l[a]=se(f),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=n.length}},d(i){i&&I(e),ue(l,i)}}}function se(t){let e,n=t[32].label+"",l,i,s,a;function f(){return t[27](t[32])}function b(){return t[28](t[32])}function g(){return t[31](t[34],t[32])}return{c(){e=P("button"),l=Ae(n),i=S(),v(e,"class","legend-item svelte-303fln"),y(e,"background-color",t[9]&&t[32].label in t[9]?t[9][t[32].label]+"88":`hsla(${Math.round(t[34]*360/t[15].annotations.length)}, 100%, 50%, 0.3)`)},m(h,_){M(h,e,_),C(e,l),C(e,i),s||(a=[j(e,"mouseover",f),j(e,"focus",b),j(e,"mouseout",t[29]),j(e,"blur",t[30]),j(e,"click",g)],s=!0)},p(h,_){t=h,_[0]&32768&&n!==(n=t[32].label+"")&&$e(l,n),_[0]&33280&&y(e,"background-color",t[9]&&t[32].label in t[9]?t[9][t[32].label]+"88":`hsla(${Math.round(t[34]*360/t[15].annotations.length)}, 100%, 50%, 0.3)`)},d(h){h&&I(e),s=!1,Ve(a)}}}function Ke(t){let e,n;return e=new oe({}),{c(){z(e.$$.fragment)},m(l,i){N(e,l,i),n=!0},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){p(e.$$.fragment,l),n=!1},d(l){q(e,l)}}}function Oe(t){let e,n,l,i,s,a,f,b;const g=[{autoscroll:t[3].autoscroll},{i18n:t[3].i18n},t[13]];let h={};for(let u=0;u<g.length;u+=1)h=Fe(h,g[u]);e=new Me({props:h}),l=new Be({props:{show_label:t[5],Icon:oe,label:t[4]||t[3].i18n("image.image")}});const _=[He,Ge],m=[];function r(u,c){return u[15]==null?0:1}return a=r(t),f=m[a]=_[a](t),{c(){z(e.$$.fragment),n=S(),z(l.$$.fragment),i=S(),s=P("div"),f.c(),v(s,"class","container svelte-303fln")},m(u,c){N(e,u,c),M(u,n,c),N(l,u,c),M(u,i,c),M(u,s,c),m[a].m(s,null),b=!0},p(u,c){const d=c[0]&8200?je(g,[c[0]&8&&{autoscroll:u[3].autoscroll},c[0]&8&&{i18n:u[3].i18n},c[0]&8192&&Pe(u[13])]):{};e.$set(d);const B={};c[0]&32&&(B.show_label=u[5]),c[0]&24&&(B.label=u[4]||u[3].i18n("image.image")),l.$set(B);let F=a;a=r(u),a===F?m[a].p(u,c):(R(),p(m[F],1,1,()=>{m[F]=null}),Q(),f=m[a],f?f.p(u,c):(f=m[a]=_[a](u),f.c()),k(f,1),f.m(s,null))},i(u){b||(k(e.$$.fragment,u),k(l.$$.fragment,u),k(f),b=!0)},o(u){p(e.$$.fragment,u),p(l.$$.fragment,u),p(f),b=!1},d(u){u&&(I(n),I(i),I(s)),q(e,u),q(l,u),m[a].d()}}}function Qe(t){let e,n;return e=new Ie({props:{visible:t[2],elem_id:t[0],elem_classes:t[1],padding:!1,height:t[7],width:t[8],allow_overflow:!1,container:t[10],scale:t[11],min_width:t[12],$$slots:{default:[Oe]},$$scope:{ctx:t}}}),{c(){z(e.$$.fragment)},m(l,i){N(e,l,i),n=!0},p(l,i){const s={};i[0]&4&&(s.visible=l[2]),i[0]&1&&(s.elem_id=l[0]),i[0]&2&&(s.elem_classes=l[1]),i[0]&128&&(s.height=l[7]),i[0]&256&&(s.width=l[8]),i[0]&1024&&(s.container=l[10]),i[0]&2048&&(s.scale=l[11]),i[0]&4096&&(s.min_width=l[12]),i[0]&516856|i[1]&32&&(s.$$scope={dirty:i,ctx:l}),e.$set(s)},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){p(e.$$.fragment,l),n=!1},d(l){q(e,l)}}}function Re(t,e,n){let{elem_id:l=""}=e,{elem_classes:i=[]}=e,{visible:s=!0}=e,{value:a=null}=e,f=null,b=null,{gradio:g}=e,{label:h=g.i18n("annotated_image.annotated_image")}=e,{show_label:_=!0}=e,{show_legend:m=!0}=e,{height:r}=e,{width:u}=e,{color_map:c}=e,{container:d=!0}=e,{scale:B=null}=e,{min_width:F=void 0}=e,D=null,{loading_status:T}=e,{show_fullscreen_button:U=!0}=e,G=!1,V;De(()=>{document.addEventListener("fullscreenchange",()=>{n(17,G=!!document.fullscreenElement)})});const _e=async()=>{G?await document.exitFullscreen():await V.requestFullscreen()};let H=null;function J(o){n(16,D=o)}function K(){n(16,D=null)}function X(o,W){g.dispatch("select",{value:h,index:o})}function me(o){Le[o?"unshift":"push"](()=>{V=o,n(18,V)})}const ce=o=>J(o.label),he=o=>J(o.label),ge=()=>K(),be=()=>K(),de=(o,W)=>X(o,W.label);return t.$$set=o=>{"elem_id"in o&&n(0,l=o.elem_id),"elem_classes"in o&&n(1,i=o.elem_classes),"visible"in o&&n(2,s=o.visible),"value"in o&&n(23,a=o.value),"gradio"in o&&n(3,g=o.gradio),"label"in o&&n(4,h=o.label),"show_label"in o&&n(5,_=o.show_label),"show_legend"in o&&n(6,m=o.show_legend),"height"in o&&n(7,r=o.height),"width"in o&&n(8,u=o.width),"color_map"in o&&n(9,c=o.color_map),"container"in o&&n(10,d=o.container),"scale"in o&&n(11,B=o.scale),"min_width"in o&&n(12,F=o.min_width),"loading_status"in o&&n(13,T=o.loading_status),"show_fullscreen_button"in o&&n(14,U=o.show_fullscreen_button)},t.$$.update=()=>{if(t.$$.dirty[0]&58720264)if(a!==f&&(n(24,f=a),g.dispatch("change")),a){const o={image:a.image,annotations:a.annotations.map(L=>({image:L.image,label:L.label}))};n(15,b=o);const W=Z(o.image.url),we=Promise.all(o.annotations.map(L=>Z(L.image.url))),O=Promise.all([W,we]);n(25,H=O),O.then(([L,ke])=>{if(H!==O)return;const ve={image:{...o.image,url:L??void 0},annotations:o.annotations.map((Y,pe)=>({...Y,image:{...Y.image,url:ke[pe]??void 0}}))};n(15,b=ve)})}else n(15,b=null)},[l,i,s,g,h,_,m,r,u,c,d,B,F,T,U,b,D,G,V,_e,J,K,X,a,f,H,me,ce,he,ge,be,de]}class nl extends Se{constructor(e){super(),Ce(this,e,Re,Qe,We,{elem_id:0,elem_classes:1,visible:2,value:23,gradio:3,label:4,show_label:5,show_legend:6,height:7,width:8,color_map:9,container:10,scale:11,min_width:12,loading_status:13,show_fullscreen_button:14},null,[-1,-1])}get elem_id(){return this.$$.ctx[0]}set elem_id(e){this.$$set({elem_id:e}),w()}get elem_classes(){return this.$$.ctx[1]}set elem_classes(e){this.$$set({elem_classes:e}),w()}get visible(){return this.$$.ctx[2]}set visible(e){this.$$set({visible:e}),w()}get value(){return this.$$.ctx[23]}set value(e){this.$$set({value:e}),w()}get gradio(){return this.$$.ctx[3]}set gradio(e){this.$$set({gradio:e}),w()}get label(){return this.$$.ctx[4]}set label(e){this.$$set({label:e}),w()}get show_label(){return this.$$.ctx[5]}set show_label(e){this.$$set({show_label:e}),w()}get show_legend(){return this.$$.ctx[6]}set show_legend(e){this.$$set({show_legend:e}),w()}get height(){return this.$$.ctx[7]}set height(e){this.$$set({height:e}),w()}get width(){return this.$$.ctx[8]}set width(e){this.$$set({width:e}),w()}get color_map(){return this.$$.ctx[9]}set color_map(e){this.$$set({color_map:e}),w()}get container(){return this.$$.ctx[10]}set container(e){this.$$set({container:e}),w()}get scale(){return this.$$.ctx[11]}set scale(e){this.$$set({scale:e}),w()}get min_width(){return this.$$.ctx[12]}set min_width(e){this.$$set({min_width:e}),w()}get loading_status(){return this.$$.ctx[13]}set loading_status(e){this.$$set({loading_status:e}),w()}get show_fullscreen_button(){return this.$$.ctx[14]}set show_fullscreen_button(e){this.$$set({show_fullscreen_button:e}),w()}}export{nl as default};
//# sourceMappingURL=Index-DHGmWoJC.js.map
